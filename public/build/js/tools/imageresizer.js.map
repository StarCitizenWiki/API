{"version":3,"sources":["imageresizer.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"imageresizer.js","sourcesContent":["/**\r\n * Created by Hanne on 05.02.2017.\r\n */\r\nvar selectionRectangleOffset = 0;\r\nvar aspectRatio = 0;\r\nvar imageLoaded = false;\r\n\r\nvar canvasImage = new Image();\r\nvar imageLoader = document.getElementById('image');\r\nimageLoader.addEventListener('change', loadImageToCanvas, false);\r\n\r\nvar rectangleSlider = document.getElementById('rectangleSlider');\r\n\r\nvar mainCanvas = document.getElementById('imageCanvas');\r\nmainCanvas.width = displayWidth;\r\nvar mainCanvasContext = mainCanvas.getContext('2d');\r\n\r\nvar hiddenFullSizeCanvas = document.getElementById('hiddenCanvas');\r\nhiddenFullSizeCanvas.width = outputWidth;\r\nvar hiddenCanvasContext = hiddenFullSizeCanvas.getContext('2d');\r\n\r\nvar saveButton = document.getElementById('save');\r\nsaveButton.onclick = function() {\r\n    saveImageToDisk(hiddenFullSizeCanvas, this);\r\n};\r\n\r\nfunction loadImageToCanvas(event) {\r\n    var reader = new FileReader();\r\n    reader.onload = function(event) {\r\n        canvasImage.onload = function() {\r\n            setCanvasAttributes();\r\n            drawImages();\r\n            drawSelectionRectangle(0, selectionRectangleOffset, displayWidth, displayHeight);\r\n            imageLoaded = true;\r\n        };\r\n        canvasImage.src = event.target.result;\r\n    };\r\n    reader.readAsDataURL(event.target.files[0]);\r\n}\r\n\r\nfunction setCanvasAttributes() {\r\n    aspectRatio = canvasImage.width / canvasImage.height;\r\n\r\n    mainCanvas.height = displayWidth / aspectRatio;\r\n    hiddenFullSizeCanvas.height = outputWidth / aspectRatio;\r\n\r\n    rectangleSlider.max = mainCanvas.height - HALF_SELECTION_RECTANGLE_SIZE;\r\n}\r\n\r\nfunction drawImages() {\r\n    mainCanvasContext.drawImage(canvasImage, 0, 0, displayWidth, mainCanvas.height);\r\n    hiddenCanvasContext.drawImage(canvasImage, 0, 0, outputWidth, hiddenFullSizeCanvas.height);\r\n}\r\n\r\nfunction drawSelectionRectangle(offsetX, offsetY, rectangleWidth, rectangleHeight) {\r\n    mainCanvasContext.strokeStyle = selectionRectangleColor;\r\n    mainCanvasContext.strokeRect(offsetX, offsetY, rectangleWidth, rectangleHeight);\r\n}\r\n\r\nfunction moveSelectionRectangle(offsetY) {\r\n    if (imageLoaded)\r\n    {\r\n        if (offsetY < 0) {\r\n            offsetY = 0;\r\n        } else if (offsetY > mainCanvas.height - HALF_SELECTION_RECTANGLE_SIZE) {\r\n            offsetY = mainCanvas.height - HALF_SELECTION_RECTANGLE_SIZE;\r\n        }\r\n        selectionRectangleOffset = offsetY;\r\n        mainCanvasContext.clearRect(0, 0, mainCanvas.width, mainCanvas.height);\r\n        mainCanvasContext.drawImage(canvasImage,0,0, displayWidth, mainCanvas.height);\r\n        drawSelectionRectangle(0, selectionRectangleOffset, displayWidth, displayHeight);\r\n    }\r\n}\r\n\r\nfunction saveImageToDisk(sourceCanvas, windowContext) {\r\n    var buffer = document.createElement('canvas');\r\n    var bufferContext = buffer.getContext('2d');\r\n    var offsetY = selectionRectangleOffset * 2;\r\n    buffer.width = outputWidth;\r\n    buffer.height = outputHeight;\r\n    bufferContext.drawImage(sourceCanvas, 0, offsetY, outputWidth, outputHeight, 0, 0, outputWidth, outputHeight);\r\n    windowContext.href = buffer.toDataURL(\"image/jpeg\");\r\n    windowContext.download = 'kopfbild.jpg';\r\n}"]}